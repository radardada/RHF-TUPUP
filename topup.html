<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Proses Topup</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body { margin:0; font-family:Inter,system-ui; background:#0f1220; color:#e9ecf5; }
    .container { max-width:720px; margin:24px auto; padding:0 20px; }
    .card { background:#171a2b; border:1px solid #23263a; border-radius:14px; padding:18px; margin-bottom:20px; }
    .input { width:100%; padding:12px; border-radius:10px; border:1px solid #23263a; background:#121528; color:#e9ecf5; }
    .pkg { display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:12px; }
    .pkg-item { background:#121528; border:1px solid #23263a; border-radius:12px; padding:12px; cursor:pointer; }
    .pkg-item.active { border-color:#00d4a6; }
    .chip { padding:8px 12px; border-radius:999px; background:#121528; border:1px solid #23263a; cursor:pointer; }
    .chip.active { border-color:#5b8cff; }
    .btn { padding:12px 16px; border-radius:10px; background:#5b8cff; color:#fff; font-weight:700; border:0; cursor:pointer; }
    .error { color:#ff5b6e; font-weight:600; }
    .success { color:#00d4a6; font-weight:600; }
    .logo { text-align:center; margin-bottom:20px; }
    .logo img { width:100px; height:100px; object-fit:contain; }
  </style>
</head>
<body>
  <div class="container">
    <!-- Logo game -->
    <div class="logo" id="gameLogo"></div>

    <!-- Input akun -->
    <div class="card">
      <h2>Informasi Akun</h2>
      <div id="accountFields"></div>
      <label class="muted">Kontak</label>
      <input id="contact" class="input" placeholder="WhatsApp / Email">
    </div>

    <!-- Paket -->
    <div class="card">
      <h2>Pilih Paket</h2>
      <div id="packages" class="pkg"></div>
    </div>

    <!-- Metode pembayaran -->
    <div class="card">
      <h2>Metode Pembayaran</h2>
      <div id="payMethods"></div>
      <button id="payBtn" class="btn">Bayar Sekarang</button>
      <p id="payMsg"></p>
    </div>
  </div>

  <script type="module">
    // ambil parameter game dari URL
    const params = new URLSearchParams(location.search);
    const gameKey = params.get('game') || 'ff';

    // config game (contoh singkat)
    const GAME_CONFIG = {
      ff: {
        name:'Free Fire',
        logo:'https://upload.wikimedia.org/wikipedia/en/c/c5/Logo_of_Garena_Free_Fire.png',
        fields:[{id:'ff_id',label:'Player ID',placeholder:'Contoh: 123456789'}],
        packages:[{id:'ff_50',title:'50 Diamonds',price:9000},{id:'ff_100',title:'100 Diamonds',price:17000}]
      },
      ml: {
        name:'Mobile Legends',
        logo:'https://assets.stickpng.com/images/62061920cdd94000043e3951.png',
        fields:[{id:'ml_id',label:'ID (Server)',placeholder:'Contoh: 12345678 (1234)'}],
        packages:[{id:'ml_86',title:'86 Diamonds',price:20000}]
      }
      // tambahkan game lain sesuai kebutuhan
    };

    const game = GAME_CONFIG[gameKey];
    document.getElementById('gameLogo').innerHTML = `<img src="${game.logo}" alt="${game.name}"><h2>${game.name}</h2>`;

    // render fields
    const accountFields = document.getElementById('accountFields');
    game.fields.forEach(f=>{
      const div=document.createElement('div');
      div.innerHTML=`<label>${f.label}</label><input id="${f.id}" class="input" placeholder="${f.placeholder}">`;
      accountFields.appendChild(div);
    });

    // render packages
    const packages=document.getElementById('packages');
    game.packages.forEach(p=>{
      const item=document.createElement('div');
      item.className='pkg-item';
      item.innerHTML=`<div>${p.title}</div><div>Rp ${p.price.toLocaleString('id-ID')}</div>`;
      item.addEventListener('click',()=>{ 
        document.querySelectorAll('.pkg-item').forEach(el=>el.classList.remove('active'));
        item.classList.add('active');
        selectedPkg=p;
      });
      packages.appendChild(item);
    });

    // render metode pembayaran
    const payMethods=document.getElementById('payMethods');
    ['saldo','ewallet'].forEach(m=>{
      const chip=document.createElement('button');
      chip.className='chip'+(m==='saldo'?' active':'');
      chip.textContent=(m==='saldo'?'Saldo RHF':'E-Wallet (DANA/OVO/GoPay/ShopeePay/QRIS)');
      chip.addEventListener('click',()=>{
        document.querySelectorAll('.chip').forEach(el=>el.classList.remove('active'));
        chip.classList.add('active');
        selectedPay=m;
      });
      payMethods.appendChild(chip);
    });

    let selectedPkg=null;
    let selectedPay='saldo';

    document.getElementById('payBtn').addEventListener('click',()=>{
      const msg=document.getElementById('payMsg');
      msg.textContent='';
      const contact=document.getElementById('contact').value.trim();
      if(!selectedPkg){ msg.textContent='Pilih paket dulu'; msg.className='error'; return; }
      if(!contact){ msg.textContent='Isi kontak'; msg.className='error'; return; }
      if(selectedPay==='saldo'){
        msg.textContent='Pembayaran dengan Saldo RHF diproses...'; msg.className='success';
        // logika saldo: cek saldo di Firebase, kurangi kalau cukup, kalau tidak cukup masuk admin
      }else{
        msg.textContent='Dialihkan ke halaman tunggu untuk upload bukti e-wallet...'; msg.className='success';
        location.href=`tunggu.html?order=ORD123&game=${gameKey}`;
      }
    });
  </script>
</body>
</html>
