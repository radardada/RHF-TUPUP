<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Top Up - RHF</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Poppins', sans-serif; background: #f8f9fa; color: #333; min-height: 100vh; }
    .container { max-width: 500px; margin: 0 auto; padding: 20px; }

    .header { background: linear-gradient(to right, #ff6600, #ff8800); color: white; padding: 30px; text-align: center; border-radius: 0 0 30px 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); }
    .header h1 { font-size: 28px; margin-bottom: 15px; }

    .game-logos { display: flex; overflow-x: auto; gap: 15px; padding: 10px 0; scrollbar-width: none; }
    .game-logos::-webkit-scrollbar { display: none; }
    .game-logo { width: 80px; height: 80px; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.2); flex-shrink: 0; }
    .game-logo img { width: 100%; height: 100%; object-fit: contain; background: white; padding: 8px; }

    .form-section { background: white; border-radius: 20px; padding: 25px; margin: 20px 0; box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
    .form-group { margin-bottom: 20px; }
    .form-group label { display: block; font-weight: 600; margin-bottom: 8px; font-size: 15px; }
    .form-group input { width: 100%; padding: 14px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; }

    .nominal-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 20px 0; }
    .nominal-card { background: #f8f9fa; border: 2px solid #ddd; border-radius: 12px; padding: 15px; text-align: center; cursor: pointer; transition: 0.3s; }
    .nominal-card:hover, .nominal-card.active { border-color: #ff6600; background: #fffaf5; }
    .nominal-card .diamond { font-size: 18px; font-weight: 700; color: #ff6600; }
    .nominal-card .price { font-size: 16px; font-weight: 600; }
    .nominal-card .discount { font-size: 12px; color: #28a745; }

    .payment-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 25px 0; }
    .payment-item { background: #f8f9fa; border: 2px solid #ddd; border-radius: 12px; padding: 15px; text-align: center; cursor: pointer; transition: 0.3s; }
    .payment-item:hover, .payment-item.active { border-color: #ff6600; background: #fffaf5; }
    .payment-item i { font-size: 30px; margin-bottom: 8px; color: #ff6600; }
    .payment-item p { font-weight: 600; font-size: 14px; }

    .btn-pay { width: 100%; padding: 18px; background: linear-gradient(to right, #ff6600, #ff8800); color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: 700; cursor: pointer; margin-top: 20px; }
    .btn-pay:hover { opacity: 0.9; }

    footer { text-align: center; padding: 30px; color: #777; font-size: 14px; }
  </style>
</head>
<body>

  <header>
    <h1>Top Up Game</h1>
    <!-- Carousel logo game sama seperti di index.html (horizontal scroll) -->
    <div class="game-logos">
      <div class="game-logo"><img src="https://assets.stickpng.com/images/62061920cdd94000043e3951.png" alt="ML"></div>
      <div class="game-logo"><img src="https://upload.wikimedia.org/wikipedia/en/c/c5/Logo_of_Garena_Free_Fire.png" alt="FF"></div>
      <div class="game-logo"><img src="https://upload.wikimedia.org/wikipedia/commons/4/43/PUBG_Mobile_simple_logo_black.png" alt="PUBG"></div>
      <div class="game-logo"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/Valorant_logo_-_pink_color_version.svg/2560px-Valorant_logo_-_pink_color_version.svg.png" alt="Valorant"></div>
      <div class="game-logo"><img src="https://www.freepnglogos.com/uploads/genshin-impact-logo-png/hd-transparent-logo-genshin-impact-free-download-2.png" alt="Genshin"></div>
      <div class="game-logo"><img src="https://logowik.com/content/uploads/images/bigo-live2708.jpg" alt="Bigo"></div>
      <!-- Tambah logo lain sesuai index.html kamu -->
    </div>
  </header>

  <div class="container">
    <div class="form-section">
      <div class="form-group">
        <label>User ID / Player ID</label>
        <input type="text" id="userId" placeholder="Masukkan ID Anda" required>
      </div>

      <div class="form-group">
        <label>Pilih Nominal</label>
        <div class="nominal-grid">
          <div class="nominal-card" onclick="selectNominal(this, '86000', 'Rp 15.000')">
            <div class="diamond">86 Diamonds</div>
            <div class="price">Rp 15.000</div>
            <div class="discount">Hemat 5%</div>
          </div>
          <div class="nominal-card" onclick="selectNominal(this, '172000', 'Rp 30.000')">
            <div class="diamond">172 Diamonds</div>
            <div class="price">Rp 30.000</div>
            <div class="discount">Hemat 8%</div>
          </div>
          <div class="nominal-card" onclick="selectNominal(this, '257000', 'Rp 45.000')">
            <div class="diamond">257 Diamonds</div>
            <div class="price">Rp 45.000</div>
            <div class="discount">Hemat 10%</div>
          </div>
          <div class="nominal-card" onclick="selectNominal(this, '344000', 'Rp 60.000')">
            <div class="diamond">344 Diamonds</div>
            <div class="price">Rp 60.000</div>
            <div class="discount">Hemat 12%</div>
          </div>
          <!-- Tambah nominal lain sesuai kebutuhan -->
        </div>
      </div>

      <div class="payment-options">
        <label>Pilih Metode Pembayaran</label>
        <div class="payment-grid">
          <div class="payment-item active" onclick="selectPayment('saldo', this)">
            <i class="fas fa-wallet"></i>
            <p>Saldo RHF</p>
          </div>
          <div class="payment-item" onclick="selectPayment('dana', this)">
            <i class="fas fa-mobile-alt"></i>
            <p>DANA</p>
          </div>
          <div class="payment-item" onclick="selectPayment('ovo', this)">
            <i class="fas fa-mobile"></i>
            <p>OVO</p>
          </div>
          <div class="payment-item" onclick="selectPayment('gopay', this)">
            <i class="fas fa-mobile"></i>
            <p>GoPay</p>
          </div>
          <div class="payment-item" onclick="selectPayment('shopeepay', this)">
            <i class="fas fa-shopping-cart"></i>
            <p>ShopeePay</p>
          </div>
        </div>
      </div>

      <button class="btn-pay" onclick="prosesTopup()">Bayar Sekarang</button>
    </div>
  </div>

  <footer>
    <p>Â© 2026 RHF - Top Up Aman & Cepat</p>
  </footer>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyALIhKFz4bpOPmES6t2fAdx8VMPP0ye1wc",
      authDomain: "rhf-resmi.firebaseapp.com",
      databaseURL: "https://rhf-resmi-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "rhf-resmi",
      storageBucket: "rhf-resmi.appspot.com",
      messagingSenderId: "313439235544",
      appId: "1:313439235544:web:b19a2ad538e34c1fe516ad",
      measurementId: "G-LNCVH73P3X"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const userKey = localStorage.getItem('userKey');
    if (!userKey) {
      alert('Login terlebih dahulu');
      location.href = 'login.html';
    }

    let selectedNominal = '';
    let selectedPrice = '';

    function selectNominal(element, nominal, price) {
      document.querySelectorAll('.nominal-card').forEach(card => card.classList.remove('active'));
      element.classList.add('active');
      selectedNominal = nominal;
      selectedPrice = price;
    }

    let selectedPayment = 'saldo';

    function selectPayment(method, element) {
      selectedPayment = method;
      document.querySelectorAll('.payment-item').forEach(item => item.classList.remove('active'));
      element.classList.add('active');
    }

    function prosesTopup() {
      const userId = document.getElementById('userId').value.trim();
      if (!userId) return alert('Masukkan User ID');
      if (!selectedNominal) return alert('Pilih nominal top up');

      const harga = parseInt(selectedPrice.replace('Rp ', '').replace(/\./g, ''));

      if (selectedPayment === 'saldo') {
        db.ref('users/' + userKey + '/saldo').transaction(saldo => {
          const current = saldo || 0;
          if (current >= harga) {
            return current - harga;
          } else {
            alert('Saldo tidak cukup!');
            return saldo;
          }
        }).then(result => {
          if (result.committed) {
            saveOrder(userId);
            localStorage.setItem('topupSuccess', JSON.stringify({ id: userId, nominal: selectedPrice, payment: 'Saldo RHF' }));
            location.href = 'konfirmasi.html';
          }
        });
      } else {
        // Untuk metode lain (simulasi)
        alert(`Proses pembayaran via ${selectedPayment.toUpperCase()} untuk ${selectedPrice}`);
        saveOrder(userId);
        localStorage.setItem('topupSuccess', JSON.stringify({ id: userId, nominal: selectedPrice, payment: selectedPayment.toUpperCase() }));
        location.href = 'konfirmasi.html';
      }
    }

    function saveOrder(userId) {
      db.ref('orders').push({
        userKey: userKey,
        gameId: userId,
        nominal: selectedNominal,
        harga: selectedPrice,
        payment: selectedPayment,
        status: 'pending',
        timestamp: Date.now()
      });
    }
  </script>
</body>
</html>
